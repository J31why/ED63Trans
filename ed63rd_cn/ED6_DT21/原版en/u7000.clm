calmare tc scena
scena:
	name "Gaiden2" "U7000.x"
	town town[1]
	bgm bgm[210]
	item fn[0,65535]
	scp 0 "u7000._sn"
	scp 1 "u7000_1._sn"
	scp 2 "u7000_2._sn"
	scp 3 "u7000_3._sn"
	scp 4 "u7000_4._sn"
	scp 5 "u7000_5._sn"
	scp 6 "sub000._sn"

entry:
	pos (0, 0, 0)
	chr 4
	angle 5deg
	cam_from (0, 9500, -10000)
	cam_at (0, 0, 2500)
	cam_zoom 2800
	cam_pers 262
	cam_deg 45deg
	cam_limit 0deg 360deg
	north 0deg
	flags 0x0001
	town town[1]
	init fn[0,0]
	reinit fn[0,1]

chip[0] "npl/ch02891._ch" "npl/ch02891p._cp"
chip[1] "npl2/ch03080._ch" "npl2/ch03080p._cp"
chip[2] "npl2/ch03150._ch" "npl2/ch03150p._cp"
chip[3] "npl/ch00060._ch" "npl/ch00060p._cp"
chip[4] "npl2/ch03580._ch" "npl2/ch03580p._cp"
chip[5] "npl2/ch03570._ch" "npl2/ch03570p._cp"
chip[6] "npl2/ch03100._ch" "npl2/ch03100p._cp"
chip[7] "npl2/ch03250._ch" "npl2/ch03250p._cp"
chip[8] "npl2/ch03210._ch" "npl2/ch03210p._cp"
chip[9] "npl/ch02323._ch" "npl/ch02323p._cp"
chip[10] "npl2/ch03260._ch" "npl2/ch03260p._cp"
chip[11] "npl/ch00070._ch" "npl/ch00070p._cp"
chip[12] "npl/ch01630._ch" "npl/ch01630p._cp"
chip[13] "npl2/ch03240._ch" "npl2/ch03240p._cp"
chip[14] "apl/ch20053._ch" "apl/ch20053p._cp"
chip[15] "npl2/ch03000._ch" "npl2/ch03000p._cp"
chip[16] "npl/ch02030._ch" "npl/ch02030p._cp"
chip[17] "npl2/ch03510._ch" "npl2/ch03510p._cp"
chip[18] "npl/ch02760._ch" "npl/ch02760p._cp"

npc char[0]:
	name "Sealing Stone Use Dummy"
	pos (9000000, 9000000, 0)
	angle 180deg
	x 0
	cp chip[0]
	frame 0
	ch chip[0]
	flags 0x01C4
	init fn[65535,65535]
	talk fn[65535,65535]

npc char[1]:
	name "Tita"
	pos (9000000, 9000000, 0)
	angle 180deg
	x 0
	cp chip[3]
	frame 0
	ch chip[3]
	flags 0x0181
	init fn[65535,65535]
	talk fn[65535,65535]

npc char[2]:
	name "Julia"
	pos (9000000, 9000000, 0)
	angle 180deg
	x 0
	cp chip[4]
	frame 0
	ch chip[4]
	flags 0x0181
	init fn[65535,65535]
	talk fn[5,17]

npc char[3]:
	name "Mueller"
	pos (9000000, 9000000, 0)
	angle 180deg
	x 0
	cp chip[5]
	frame 0
	ch chip[5]
	flags 0x0181
	init fn[65535,65535]
	talk fn[5,18]

npc char[4]:
	name "Josette"
	pos (9000000, 9000000, 0)
	angle 180deg
	x 0
	cp chip[6]
	frame 0
	ch chip[6]
	flags 0x0181
	init fn[65535,65535]
	talk fn[65535,65535]

npc char[5]:
	name "Joshua"
	pos (9000000, 9000000, 0)
	angle 180deg
	x 0
	cp chip[7]
	frame 0
	ch chip[7]
	flags 0x0181
	init fn[65535,65535]
	talk fn[5,16]

npc char[6]:
	name "Kloe"
	pos (9000000, 9000000, 0)
	angle 180deg
	x 0
	cp chip[8]
	frame 0
	ch chip[8]
	flags 0x0181
	init fn[65535,65535]
	talk fn[5,13]

npc char[7]:
	name "Sieg"
	pos (9000000, 9000000, 0)
	angle 180deg
	x 0
	cp chip[9]
	frame 0
	ch chip[9]
	flags 0x0181
	init fn[65535,65535]
	talk fn[65535,65535]

npc char[8]:
	name "Olivier"
	pos (9000000, 9000000, 0)
	angle 180deg
	x 0
	cp chip[10]
	frame 0
	ch chip[10]
	flags 0x0181
	init fn[65535,65535]
	talk fn[65535,65535]

npc char[9]:
	name "Zin"
	pos (9000000, 9000000, 0)
	angle 180deg
	x 0
	cp chip[11]
	frame 0
	ch chip[11]
	flags 0x0181
	init fn[65535,65535]
	talk fn[65535,65535]

npc char[10]:
	name "Anelace"
	pos (9000000, 9000000, 0)
	angle 180deg
	x 0
	cp chip[12]
	frame 0
	ch chip[12]
	flags 0x0181
	init fn[65535,65535]
	talk fn[5,14]

npc char[11]:
	name "Scherazard"
	pos (9000000, 9000000, 0)
	angle 180deg
	x 0
	cp chip[13]
	frame 0
	ch chip[13]
	flags 0x0181
	init fn[65535,65535]
	talk fn[65535,65535]

npc char[12]:
	name "Agate"
	pos (9000000, 9000000, 0)
	angle 180deg
	x 0
	cp chip[14]
	frame 0
	ch chip[14]
	flags 0x0181
	init fn[65535,65535]
	talk fn[65535,65535]

npc char[13]:
	name "Estelle"
	pos (9000000, 9000000, 0)
	angle 180deg
	x 0
	cp chip[15]
	frame 0
	ch chip[15]
	flags 0x0181
	init fn[65535,65535]
	talk fn[65535,65535]

npc char[14]:
	name "Richard"
	pos (9000000, 9000000, 0)
	angle 180deg
	x 0
	cp chip[16]
	frame 0
	ch chip[16]
	flags 0x0181
	init fn[65535,65535]
	talk fn[5,15]

npc char[15]:
	name "Renne"
	pos (9000000, 9000000, 0)
	angle 180deg
	x 0
	cp chip[17]
	frame 0
	ch chip[17]
	flags 0x0181
	init fn[65535,65535]
	talk fn[65535,65535]

npc char[16]:
	name "Ries"
	pos (9000000, 9000000, 0)
	angle 180deg
	x 0
	cp chip[2]
	frame 0
	ch chip[2]
	flags 0x0181
	init fn[65535,65535]
	talk fn[65535,65535]

npc char[17]:
	name "Kevin"
	pos (9000000, 9000000, 0)
	angle 180deg
	x 0
	cp chip[1]
	frame 0
	ch chip[1]
	flags 0x0181
	init fn[65535,65535]
	talk fn[5,12]

npc char[18]:
	name "Celeste"
	pos (9000000, 9000000, 0)
	angle 180deg
	x 0
	cp chip[0]
	frame 0
	ch chip[0]
	flags 0x0181
	init fn[65535,65535]
	talk fn[5,9]

trigger[0]:
	pos1 (-3130, -1000, -25960)
	pos2 (2560, 5000, -21230)
	flags 0x0000
	func fn[0,11]
	unk1 0

trigger[1]:
	pos1 (-32520, 0, -33320)
	pos2 (4000, 26000, 0)
	flags 0x0040
	func fn[0,12]
	unk1 0

trigger[2]:
	pos1 (33060, 0, -34510)
	pos2 (4000, 27000, 0)
	flags 0x0040
	func fn[0,13]
	unk1 0

trigger[3]:
	pos1 (-3550, 10000, 34560)
	pos2 (3210, 15000, 38550)
	flags 0x0000
	func fn[1,4]
	unk1 0

trigger[4]:
	pos1 (0, 0, 0)
	pos2 (0, 0, 0)
	flags 0x0002
	func fn[0,7]
	unk1 0

trigger[5]:
	pos1 (-3070, 2000, -19730)
	pos2 (2940, 8000, -15500)
	flags 0x0000
	func fn[1,17]
	unk1 0

trigger[6]:
	pos1 (-15750, 1500, -13530)
	pos2 (4000, 5200, 0)
	flags 0x0040
	func fn[1,18]
	unk1 0

trigger[7]:
	pos1 (16270, 1500, -13650)
	pos2 (4000, 5500, 0)
	flags 0x0040
	func fn[1,19]
	unk1 0

look_point[0]:
	pos (0, 4150, 6300)
	radius 1000mm
	bubble_pos (0, 5500, 6300)
	flags 0x007C
	func fn[0,2]
	unk1 0

look_point[1]:
	pos (0, 12000, 35000)
	radius 1000mm
	bubble_pos (0, 13500, 35000)
	flags 0x007C
	func fn[1,20]
	unk1 0

fn[0]:
	if system[66] == 255:
		switch system[0]:
			case 103:
				Event fn[0,16]
				break
	if system[66] == 255:
		switch system[0]:
			case 100:
				CharSetPos field_party[0] (130, 1000, -20490) 0deg
				CharSetPos field_party[1] (130, 1000, -20490) 0deg
				CharSetPos field_party[2] (130, 1000, -20490) 0deg
				CharSetPos field_party[3] (130, 1000, -20490) 0deg
				_30 1
				CamLookChar field_party[0] 0ms
				break
			case 101:
				CharSetPos field_party[0] (-14920, 1000, -13460) 45deg
				CharSetPos field_party[1] (-14920, 1000, -13460) 45deg
				CharSetPos field_party[2] (-14920, 1000, -13460) 45deg
				CharSetPos field_party[3] (-14920, 1000, -13460) 45deg
				_30 1
				CamLookChar field_party[0] 0ms
				break
			case 102:
				CharSetPos field_party[0] (15210, 1000, -13240) 315deg
				CharSetPos field_party[1] (15210, 1000, -13240) 315deg
				CharSetPos field_party[2] (15210, 1000, -13240) 315deg
				CharSetPos field_party[3] (15210, 1000, -13240) 315deg
				_30 1
				CamLookChar field_party[0] 0ms
				break
	Call fn[0,8]
	Call fn[0,6]
	if system[0] == 100:
		if flag[9730] && flag[9731] && flag[9732] && !flag[9733]:
			Event fn[1,5]
	elif system[0] == 101:
		if flag[9735] && flag[9737] && !flag[9738]:
			Event fn[1,24]
		elif flag[9730] && flag[9731] && flag[9732] && !flag[9733]:
			Event fn[1,8]
	elif system[0] == 102:
		if flag[9735] && flag[9737] && !flag[9738]:
			Event fn[1,25]
		elif flag[9730] && flag[9731] && flag[9732] && !flag[9733]:
			Event fn[1,11]
	elif system[0] == 103:
		if QuestFlagsGet quest[23] 0x10 && !flag[11317] && PartyPosition name[15] != -1:
			Event fn[5,22]
	elif system[0] == 104:
		if QuestFlagsGet quest[23] 0x10 && !flag[11317] && PartyPosition name[15] != -1:
			Event fn[5,19]
		elif flag[9740] && !flag[9741]:
			Event fn[1,28]
	if flag[9478] && flag[9479]:
		FlagUnset flag[9478]
		FlagUnset flag[9479]
		SystemFlagsSet 0x10000000
		system[1] = 0
		Event fn[4,16]
	elif flag[9477] && flag[9482]:
		FlagUnset flag[9477]
		FlagUnset flag[9482]
		SystemFlagsSet 0x10000000
		system[1] = 0
		Event fn[4,3]
	elif flag[9477] && flag[9481]:
		FlagUnset flag[9477]
		FlagUnset flag[9481]
		SystemFlagsSet 0x10000000
		system[1] = 0
		Event fn[4,2]
	elif flag[9477] && flag[9480]:
		FlagUnset flag[9477]
		FlagUnset flag[9480]
		SystemFlagsSet 0x10000000
		Event fn[3,17]
	elif flag[9477] && flag[9479]:
		FlagUnset flag[9477]
		FlagUnset flag[9479]
		SystemFlagsSet 0x10000000
		Event fn[3,13]
	elif flag[9477] && flag[9478]:
		FlagUnset flag[9477]
		FlagUnset flag[9478]
		SystemFlagsSet 0x10000000
		Event fn[3,11]
	elif flag[9476] && flag[9483]:
		FlagUnset flag[9476]
		FlagUnset flag[9483]
		SystemFlagsSet 0x10000000
		system[1] = 173
		Event fn[3,9]
	elif flag[9476] && flag[9482]:
		FlagUnset flag[9476]
		FlagUnset flag[9482]
		SystemFlagsSet 0x10000000
		Event fn[3,2]
	elif flag[9476] && flag[9481]:
		FlagUnset flag[9476]
		FlagUnset flag[9481]
		SystemFlagsSet 0x10000000
		Event fn[2,13]
	elif flag[9476] && flag[9480]:
		FlagUnset flag[9476]
		FlagUnset flag[9480]
		SystemFlagsSet 0x10000000
		Event fn[2,9]
	elif flag[9476] && flag[9479]:
		FlagUnset flag[9476]
		FlagUnset flag[9479]
		SystemFlagsSet 0x10000000
		Event fn[2,6]
	elif flag[9476] && flag[9478]:
		FlagUnset flag[9476]
		FlagUnset flag[9478]
		SystemFlagsSet 0x10000000
		system[1] = 0
		Event fn[2,5]
	elif flag[9476] && flag[9477]:
		FlagUnset flag[9476]
		FlagUnset flag[9477]
		SystemFlagsSet 0x10000000
		Event fn[2,3]
	elif flag[9483]:
		FlagUnset flag[9483]
		SystemFlagsSet 0x10000000
		system[1] = 0
		Event fn[2,2]
	elif flag[9482]:
		FlagUnset flag[9482]
		SystemFlagsSet 0x10000000
		Event fn[4,18]
	elif flag[9481]:
		FlagUnset flag[9481]
		SystemFlagsSet 0x10000000
		Event fn[1,38]
	elif flag[9480]:
		FlagUnset flag[9480]
		SystemFlagsSet 0x10000000
		Event fn[1,35]
	elif flag[9479]:
		FlagUnset flag[9479]
		SystemFlagsSet 0x10000000
		system[1] = 0
		Event fn[1,33]
	elif flag[9478]:
		FlagUnset flag[9478]
		SystemFlagsSet 0x10000000
		Event fn[1,32]
	elif flag[9477]:
		FlagUnset flag[9477]
		SystemFlagsSet 0x10000000
		Event fn[1,29]
	elif flag[9476]:
		FlagUnset flag[9476]
		SystemFlagsSet 0x10000000
		system[1] = 184
		Event fn[1,15]
	elif flag[9728] && !flag[9729]:
		SystemFlagsSet 0x10000000
		Event fn[1,2]
	if system[4] == 6:
		if flag[11041] && !flag[11042] && PartyPosition name[1] != -1:
			Event fn[4,15]
			Return
		if flag[11030] && !flag[11031] && PartyPosition name[11] != -1:
			Event fn[4,14]
			Return
		if flag[11017] && !flag[11019] && PartyPosition name[9] != -1:
			Event fn[4,13]
			Return
		if flag[11011] && !flag[11012] && PartyPosition name[4] != -1:
			Event fn[4,12]
			Return
	Return

fn[1]:
	MapSet 4000 (-122750, null, -160500) "mu7004._ch"
	EntranceSetDisabled entrance[0] 0
	EntranceSetDisabled entrance[1] 0
	EntranceSetDisabled entrance[2] 0
	if flag[11296]:
		system[1] = 213
		SystemFlagsSet 0x02000000
	if flag[9602] && system[4] == 5:
		system[1] = 0
	if flag[9602] && system[4] == 4:
		system[1] = 0
	if flag[9992]:
		Sc_C4Set 512
	if flag[9738]:
		_1B look_point[3] fn[0,17]
	else:
		EntranceSetDisabled entrance[3] 0
	if !flag[9733]:
		EffStop eff_instance[129] 0
	if flag[9738]:
	elif flag[9733]:
		ObjFlagsUnset object[0] 0x0004
	if !flag[9733]:
		LookPointFlagsSet look_point[0] 0x0001
		Tc_E5_1 255 name[17] 0 4
		Tc_E5_1 255 name[19] 0 4
		EffStop eff_instance[130] 0
		EffStop eff_instance[131] 0
		EffStop eff_instance[132] 0
		EffStop eff_instance[133] 0
	if flag[9738]:
		LookPointFlagsSet look_point[1] 0x0001
	elif flag[9733]:
	else:
		LookPointFlagsSet look_point[1] 0x0001
	Call fn[0,10]
	Return

fn[2]:
	if flag[9733] && !flag[9734]:
		Call fn[1,21]
		Return
	TcMonumentOpen 0 0 0
	if ItemHas item[850] 0 != 0 | ItemHas item[851] 0 != 0 | ItemHas item[852] 0 != 0 | ItemHas item[853] 0 != 0 | ItemHas item[854] 0 != 0 | ItemHas item[855] 0 != 0 | ItemHas item[856] 0 != 0 | ItemHas item[857] 0 != 0 | ItemHas item[858] 0 != 0 | ItemHas item[859] 0 != 0 | ItemHas item[860] 0 != 0 | ItemHas item[861] 0 != 0 | ItemHas item[862] 0 != 0 | ItemHas item[863] 0 != 0 | ItemHas item[864] 0 != 0 | ItemHas item[865] 0 != 0:
		Call fn[0,4]
	else:
		Call fn[0,3]
	Return

fn[3]:
	TextStart null
	FadeOut 300ms 0x00000000 100
	TextSetPos -1 60 -1 -1
	TextMessage null {
		{color 5}Select an Option{0x18}{wait}
	}
	system[40] = 24
	var[0] = 0
	while var[0] != 255:
		Menu menu[1] -1 150 1
			"Restore HP/EP" // 0
			"Shop" // 1
			"Synthesize Quartz" // 2
			"End" // 3
		MenuWait var[0]
		switch var[0]:
			case 0:
				MenuClose menu[1]
				TextClose 0
				FadeIn 300ms 0x00000000
				system[40] = 65535
				Sleep 300ms
				BgmStop 1000ms
				SoundPlay sound[12] 0 0 100
				FadeOut 1000ms 0x00000000 255
				FadeWait
				SoundPlay sound[13] 0 0 100
				Minigame 21 0 0 0 0 0 0 0 0
				_30 1
				Sleep 3500ms
				if flag[11296]:
					BgmPlay bgm[213] 0
					SystemFlagsSet 0x02000000
				else:
					BgmPlay bgm[210] 0
				system[40] = 24
				FadeIn 1000ms 0x00000000
				FadeWait
				var[0] = 255
				break
			case 1:
				MenuClose menu[1]
				TextClose 0
				ShopOpen shop[10]
				FadeOut 300ms 0x00000000 100
				TextSetPos -1 60 -1 -1
				TextMessage null {
					{color 5}Select an Option{0x18}{wait}
				}
				break
			case 2:
				MenuClose menu[1]
				TextClose 0
				ShopOpen shop[0]
				FadeOut 300ms 0x00000000 100
				TextSetPos -1 60 -1 -1
				TextMessage null {
					{color 5}Select an Option{0x18}{wait}
				}
				break
			default:
				var[0] = 255
				break
	MenuClose menu[1]
	TextClose 0
	FadeIn 300ms 0x00000000
	Sleep 300ms
	var[0] = 0
	TextEnd null
	Return

fn[4]:
	TextStart null
	FadeOut 300ms 0x00000000 100
	TextSetPos -1 60 -1 -1
	TextMessage null {
		{color 5}Select an Option{0x18}{wait}
	}
	system[40] = 24
	var[0] = 0
	while var[0] != 255:
		Menu menu[1] -1 150 1
			"Unleash Sealing Stone" // 0
			"Restore HP/EP" // 1
			"Shop" // 2
			"Synthesize Quartz" // 3
			"End" // 4
		MenuWait var[0]
		switch var[0]:
			case 0:
				MenuClose menu[1]
				TextClose 0
				system[40] = 65535
				FadeOut 1000ms 0x00000000 255
				FadeWait
				if !flag[9754]:
					Call fn[1,31]
				elif !flag[9992]:
					Call fn[1,34]
				elif !flag[9999]:
					Call fn[1,37]
				elif !flag[10004]:
					Call fn[1,39]
				elif !flag[10501]:
					Call fn[2,10]
				elif !flag[10506]:
					Call fn[2,11]
				elif !flag[10510]:
					Call fn[2,12]
				elif !flag[10756]:
					Call fn[3,10]
				elif !flag[10759]:
					Call fn[3,12]
				var[0] = 255
				break
			case 1:
				MenuClose menu[1]
				TextClose 0
				FadeIn 300ms 0x00000000
				system[40] = 65535
				Sleep 300ms
				BgmStop 1000ms
				SoundPlay sound[12] 0 0 100
				FadeOut 1000ms 0x00000000 255
				FadeWait
				SoundPlay sound[13] 0 0 100
				Minigame 21 0 0 0 0 0 0 0 0
				Sleep 3500ms
				if flag[11296]:
					BgmPlay bgm[213] 0
					SystemFlagsSet 0x02000000
				else:
					BgmPlay bgm[210] 0
				system[40] = 24
				FadeIn 1000ms 0x00000000
				FadeWait
				var[0] = 255
				break
			case 2:
				MenuClose menu[1]
				TextClose 0
				ShopOpen shop[10]
				FadeOut 300ms 0x00000000 100
				TextSetPos -1 60 -1 -1
				TextMessage null {
					{color 5}Select an Option{0x18}{wait}
				}
				break
			case 3:
				MenuClose menu[1]
				TextClose 0
				ShopOpen shop[0]
				FadeOut 300ms 0x00000000 100
				TextSetPos -1 60 -1 -1
				TextMessage null {
					{color 5}Select an Option{0x18}{wait}
				}
				break
			default:
				var[0] = 255
				break
	MenuClose menu[1]
	TextClose 0
	FadeIn 300ms 0x00000000
	Sleep 300ms
	var[0] = 0
	TextEnd null
	Return

fn[5]:
	Call fn[0,8]
	Call fn[0,6]
	Call fn[0,9]
	Return

fn[6]:
	if flag[11296]:
		ForkFunc char[17] fork[0] fn[6,2]
		ForkFunc char[2] fork[0] fn[6,2]
		ForkFunc char[3] fork[0] fn[6,2]
		ForkFunc char[6] fork[0] fn[6,2]
		if PartyPosition name[4] != -1:
			if PartyPosition name[12] == -1 && PartyPosition name[13] == -1 && PartyPosition name[8] != -1:
				CharSetPos char[3] (5860, 4000, -9280) 180deg
				CharSetPos char[2] (6050, 4000, -11760) 0deg
			elif PartyPosition name[12] == -1 && PartyPosition name[8] == -1 && PartyPosition name[13] != -1:
				CharSetPos char[3] (5860, 4000, -9280) 180deg
				CharSetPos char[17] (6050, 4000, -11760) 0deg
			elif PartyPosition name[13] == -1 && PartyPosition name[8] == -1 && PartyPosition name[12] != -1:
				CharSetPos char[2] (5860, 4000, -9280) 180deg
				CharSetPos char[17] (6050, 4000, -11760) 0deg
			elif PartyPosition name[13] != -1 && PartyPosition name[8] != -1 && PartyPosition name[12] == -1:
				CharSetPos char[3] (5860, 4000, -9280) 180deg
			elif PartyPosition name[13] != -1 && PartyPosition name[12] != -1 && PartyPosition name[8] == -1:
				CharSetPos char[17] (5860, 4000, -9280) 180deg
			elif PartyPosition name[12] != -1 && PartyPosition name[8] != -1 && PartyPosition name[13] == -1:
				CharSetPos char[2] (5860, 4000, -9280) 180deg
			else:
				CharSetPos char[2] (4280, 4000, -10900) 45deg
				CharSetPos char[17] (5860, 4000, -9280) 180deg
				CharSetPos char[3] (6050, 4000, -11760) 0deg
		elif PartyPosition name[12] != -1 && PartyPosition name[13] != -1 && PartyPosition name[8] != -1:
			CharSetPos char[6] (8000, 4000, -10850) 327deg
		elif PartyPosition name[12] == -1 && PartyPosition name[13] == -1 && PartyPosition name[8] != -1:
			CharSetPos char[3] (5860, 4000, -9280) 153deg
			CharSetPos char[2] (6050, 4000, -11760) 0deg
			CharSetPos char[6] (8000, 4000, -10850) 270deg
		elif PartyPosition name[12] == -1 && PartyPosition name[8] == -1 && PartyPosition name[13] != -1:
			CharSetPos char[3] (5860, 4000, -9280) 153deg
			CharSetPos char[17] (6050, 4000, -11760) 0deg
			CharSetPos char[6] (8000, 4000, -10850) 270deg
		elif PartyPosition name[13] == -1 && PartyPosition name[8] == -1 && PartyPosition name[12] != -1:
			CharSetPos char[2] (5860, 4000, -9280) 153deg
			CharSetPos char[17] (6050, 4000, -11760) 0deg
			CharSetPos char[6] (8000, 4000, -10850) 270deg
		elif PartyPosition name[13] != -1 && PartyPosition name[8] != -1 && PartyPosition name[12] == -1:
			CharSetPos char[3] (5860, 4000, -9280) 130deg
			CharSetPos char[6] (8000, 4000, -10850) 310deg
		elif PartyPosition name[13] != -1 && PartyPosition name[12] != -1 && PartyPosition name[8] == -1:
			CharSetPos char[17] (5860, 4000, -9280) 130deg
			CharSetPos char[6] (8000, 4000, -10850) 310deg
		elif PartyPosition name[12] != -1 && PartyPosition name[8] != -1 && PartyPosition name[13] == -1:
			CharSetPos char[2] (5860, 4000, -9280) 130deg
			CharSetPos char[6] (8000, 4000, -10850) 310deg
		else:
			CharSetPos char[2] (4280, 4000, -10900) 45deg
			CharSetPos char[17] (5860, 4000, -9280) 180deg
			CharSetPos char[3] (6050, 4000, -11760) 0deg
			CharSetPos char[6] (8000, 4000, -10850) 270deg
	Return

fn[7]:
	Call fn[0,8]
	Call fn[0,6]
	Call fn[0,9]
	Minigame 39 0 0 0 0 0 0 0 0
	if system[4] == 6:
		if flag[11041] && !flag[11042] && PartyPosition name[1] != -1:
			Call fn[4,15]
			Return
		if flag[11030] && !flag[11031] && PartyPosition name[11] != -1:
			Call fn[4,14]
			Return
		if flag[11017] && !flag[11019] && PartyPosition name[9] != -1:
			Call fn[4,13]
			Return
		if flag[11011] && !flag[11012] && PartyPosition name[4] != -1:
			Call fn[4,12]
			Return
	Return

fn[8]:
	Minigame 35 33 385 0 0 0 0 0 0
	Minigame 35 32 385 0 0 0 0 0 0
	Minigame 35 17 385 0 0 0 0 0 0
	Minigame 35 18 385 0 0 0 0 0 0
	Minigame 35 19 385 0 0 0 0 0 0
	Minigame 35 20 385 0 0 0 0 0 0
	Minigame 35 21 385 0 0 0 0 0 0
	Minigame 35 22 385 0 0 0 0 0 0
	Minigame 35 23 385 0 0 0 0 0 0
	Minigame 35 24 385 0 0 0 0 0 0
	Minigame 35 25 385 0 0 0 0 0 0
	Minigame 35 26 385 0 0 0 0 0 0
	Minigame 35 27 385 0 0 0 0 0 0
	Minigame 35 28 385 0 0 0 0 0 0
	Minigame 35 29 385 0 0 0 0 0 0
	Minigame 35 30 385 0 0 0 0 0 0
	Minigame 35 31 385 0 0 0 0 0 0
	CharSetPos char[17] (9000000, 9000000, 0) 0deg
	CharSetPos char[16] (9000000, 9000000, 0) 0deg
	CharSetPos char[1] (9000000, 9000000, 0) 0deg
	CharSetPos char[2] (9000000, 9000000, 0) 0deg
	CharSetPos char[3] (9000000, 9000000, 0) 0deg
	CharSetPos char[4] (9000000, 9000000, 0) 0deg
	CharSetPos char[5] (9000000, 9000000, 0) 0deg
	CharSetPos char[6] (9000000, 9000000, 0) 0deg
	CharSetPos char[7] (9000000, 9000000, 0) 0deg
	CharSetPos char[8] (9000000, 9000000, 0) 0deg
	CharSetPos char[9] (9000000, 9000000, 0) 0deg
	CharSetPos char[10] (9000000, 9000000, 0) 0deg
	CharSetPos char[11] (9000000, 9000000, 0) 0deg
	CharSetPos char[12] (9000000, 9000000, 0) 0deg
	CharSetPos char[13] (9000000, 9000000, 0) 0deg
	CharSetPos char[14] (9000000, 9000000, 0) 0deg
	CharSetPos char[15] (9000000, 9000000, 0) 0deg
	if PartyPosition name[6] != -1:
		CharFlagsSet char[1] 0x0080
	else:
		CharFlagsUnset char[1] 0x0080
	if PartyPosition name[13] != -1:
		CharFlagsSet char[2] 0x0080
	else:
		CharFlagsUnset char[2] 0x0080
	if PartyPosition name[12] != -1:
		CharFlagsSet char[3] 0x0080
	else:
		CharFlagsUnset char[3] 0x0080
	if PartyPosition name[10] != -1:
		CharFlagsSet char[4] 0x0080
	else:
		CharFlagsUnset char[4] 0x0080
	if PartyPosition name[1] != -1:
		CharFlagsSet char[5] 0x0080
	else:
		CharFlagsUnset char[5] 0x0080
	if PartyPosition name[4] != -1:
		CharFlagsSet char[6] 0x0080
	else:
		CharFlagsUnset char[6] 0x0080
	if PartyPosition name[3] != -1:
		CharFlagsSet char[8] 0x0080
	else:
		CharFlagsUnset char[8] 0x0080
	if PartyPosition name[7] != -1:
		CharFlagsSet char[9] 0x0080
	else:
		CharFlagsUnset char[9] 0x0080
	if PartyPosition name[9] != -1:
		CharFlagsSet char[10] 0x0080
	else:
		CharFlagsUnset char[10] 0x0080
	if PartyPosition name[2] != -1:
		CharFlagsSet char[11] 0x0080
	else:
		CharFlagsUnset char[11] 0x0080
	if PartyPosition name[5] != -1:
		CharFlagsSet char[12] 0x0080
	else:
		CharFlagsUnset char[12] 0x0080
	if PartyPosition name[0] != -1:
		CharFlagsSet char[13] 0x0080
	else:
		CharFlagsUnset char[13] 0x0080
	if PartyPosition name[11] != -1:
		CharFlagsSet char[14] 0x0080
	else:
		CharFlagsUnset char[14] 0x0080
	if PartyPosition name[15] != -1:
		CharFlagsSet char[15] 0x0080
	else:
		CharFlagsUnset char[15] 0x0080
	if PartyPosition name[14] != -1:
		CharFlagsSet char[16] 0x0080
	else:
		CharFlagsUnset char[16] 0x0080
	if PartyPosition name[8] != -1:
		CharFlagsSet char[17] 0x0080
	else:
		CharFlagsUnset char[17] 0x0080
	Return

fn[9]:
	FlagUnset flag[3]
	FlagUnset flag[4]
	FlagUnset flag[5]
	FlagUnset flag[6]
	FlagUnset flag[7]
	Return

fn[10]:
	if flag[11008]:
		CharFlagsUnset char[18] 0x0080
		CharFlagsSet char[18] 0x0004
		CharSetPos char[18] (-2100, 4500, 3610) 135deg
		ForkLoop char[18] fork[3]:
			CharAnimation self 0 7 1000ms
		CharColor char[18] 0xB4FFFFFF 0ms
		EffLoad eff[7] "map\\mp259_01.eff"
		EffPlay eff[7] eff_instance[7] char[18] 0 (0, 800, 0) 0 0 0 1600 3300 0 null (0, 0, 0) 0ms
	Return

fn[11]:
	if flag[9733] && !flag[9734]:
		var[2] = 1
		Call fn[1,16]
		Return
	if flag[10510] && !flag[10752]:
		if PartyPosition name[3] == -1:
			SystemFlagsUnset 0x02000000
			BgmStop 1000ms
	SystemFlagsSet 0x00000080
	system[40] = 65535
	FadeOut 500ms 0x00000000 255
	Fork field_party[0] fork[0]:
		_Char90 field_party[0] 0 0 -1000 1300 0
	FadeWait
	NewScene "u7001._sn" 100 0 0
	Hcf
	EventEnd 0
	Return

fn[12]:
	if flag[9733] && !flag[9734]:
		var[2] = 2
		Call fn[1,16]
		Return
	SystemFlagsSet 0x00000080
	system[40] = 65535
	FadeOut 500ms 0x00000000 255
	Fork field_party[0] fork[0]:
		_Char90 field_party[0] -1000 0 -1000 1300 0
	FadeWait
	NewScene "u7002._sn" 100 0 0
	Hcf
	EventEnd 0
	Return

fn[13]:
	if flag[9733] && !flag[9734]:
		var[2] = 3
		Call fn[1,16]
		Return
	SystemFlagsSet 0x00000080
	system[40] = 65535
	FadeOut 500ms 0x00000000 255
	Fork field_party[0] fork[0]:
		_Char90 field_party[0] 1000 0 -1000 1300 0
	FadeWait
	NewScene "u7003._sn" 100 0 0
	Hcf
	EventEnd 0
	Return

fn[14]:
	SystemFlagsSet 0x00000080
	FadeOut 0ms 0x00000000 255
	system[40] = 65535
	CharSetPos field_party[0] (-14920, 1000, -13460) 45deg
	CharSetPos field_party[1] (-14920, 1000, -13460) 45deg
	CharSetPos field_party[2] (-14920, 1000, -13460) 45deg
	CharSetPos field_party[3] (-14920, 1000, -13460) 45deg
	CamLookChar field_party[0] 0ms
	Sleep 1ms
	system[40] = 24
	FadeIn 300ms 0x00000000
	SystemFlagsUnset 0x00000080
	EventEnd 2
	Return

fn[15]:
	SystemFlagsSet 0x00000080
	FadeOut 0ms 0x00000000 255
	system[40] = 65535
	CharSetPos field_party[0] (15210, 1000, -13240) 315deg
	CharSetPos field_party[1] (15210, 1000, -13240) 315deg
	CharSetPos field_party[2] (15210, 1000, -13240) 315deg
	CharSetPos field_party[3] (15210, 1000, -13240) 315deg
	CamLookChar field_party[0] 0ms
	Sleep 1ms
	system[40] = 24
	FadeIn 300ms 0x00000000
	SystemFlagsUnset 0x00000080
	EventEnd 2
	Return

fn[16]:
	Tc_DE 0 35193091
	system[40] = 65535
	CharSetPos field_party[0] (-140, 11920, 40200) 180deg
	CharSetPos field_party[1] (-780, 11920, 41170) 180deg
	CharSetPos field_party[2] (930, 11920, 40980) 180deg
	CharSetPos field_party[3] (280, 11920, 41760) 180deg
	CamLookChar field_party[0] 0ms
	EffLoad eff[0] "map\\mp204_02.eff"
	EffPlay eff[0] eff_instance[255] null 0 (-30, 11920, 40820) 0 0 0 1000 1000 1000 null (0, 0, 0) 0ms
	SoundPlay sound[153] 0 0 100
	SoundPlay sound[184] 0 0 100
	Call fn[0,18]
	EventEnd 0
	if flag[11296]:
		SystemFlagsSet 0x02000000
	system[49] = 330
	Minigame 22 0 0 0 0 0 0 0 0
	Return

fn[17]:
	if flag[9738] && !flag[9739]:
		Call fn[1,27]
		Return
	EventBegin 1
	system[40] = 65535
	CrossFade 500ms
	CharSetPos field_party[3] (0, 11920, 40000) 0deg
	CharSetPos field_party[2] (-1000, 11920, 41000) 0deg
	CharSetPos field_party[1] (1000, 11920, 41000) 0deg
	CharSetPos field_party[0] (0, 11920, 42000) 0deg
	CamLookChar field_party[0] 0ms
	FadeWait
	EffLoad eff[0] "map\\mp204_01.eff"
	EffPlay eff[0] eff_instance[255] null 0 (-30, 11920, 40820) 0 0 0 1000 1000 1000 null (0, 0, 0) 0ms
	SoundPlay sound[153] 0 0 100
	SoundPlay sound[184] 0 0 100
	Call fn[0,19]
	if flag[11296]:
		SystemFlagsUnset 0x02000000
	NewScene "m7001._sn" 100 0 0
	Hcf
	Return

fn[18]:
	if system[10] != 255:
		CharColor field_party[0] 0x00FFFFFF 0ms
		Fork field_party[0] fork[1]:
			CharColor self 0xFFFFFFFF 800ms
	if system[11] != 255:
		CharColor field_party[1] 0x00FFFFFF 0ms
		Fork field_party[1] fork[1]:
			CharColor self 0xFFFFFFFF 800ms
	if system[12] != 255:
		CharColor field_party[2] 0x00FFFFFF 0ms
		Fork field_party[2] fork[1]:
			CharColor self 0xFFFFFFFF 800ms
	if system[13] != 255:
		CharColor field_party[3] 0x00FFFFFF 0ms
		Fork field_party[3] fork[1]:
			CharColor self 0xFFFFFFFF 800ms
	Sleep 800ms
	ForkQuit field_party[0] fork[1]
	ForkQuit field_party[1] fork[1]
	ForkQuit field_party[2] fork[1]
	ForkQuit field_party[3] fork[1]
	if system[10] != 255:
		CharColor field_party[0] 0xFFFFFFFF 0ms
	if system[11] != 255:
		CharColor field_party[1] 0xFFFFFFFF 0ms
	if system[12] != 255:
		CharColor field_party[2] 0xFFFFFFFF 0ms
	if system[13] != 255:
		CharColor field_party[3] 0xFFFFFFFF 0ms
	Return

fn[19]:
	Fork field_party[0] fork[1]:
		CharColor self 0x00FFFFFF 800ms
	Fork field_party[1] fork[1]:
		CharColor self 0x00FFFFFF 800ms
	Fork field_party[2] fork[1]:
		CharColor self 0x00FFFFFF 800ms
	Fork field_party[3] fork[1]:
		CharColor self 0x00FFFFFF 800ms
	Sleep 1000ms
	Return

fn[20]:
	EventBegin 0
	CharSetPos field_party[0] (-1000, 4000, 0) 180deg
	CharSetPos field_party[1] (1000, 4000, 0) 180deg
	CharSetPos field_party[2] (-1000, 4000, 2000) 180deg
	CharSetPos field_party[3] (1000, 4000, 2000) 180deg
	Call fn[6,27]
	EventEnd 0
	Return
